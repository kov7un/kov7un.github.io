jQuery(function(s) {
    if ("undefined" == typeof wc_cart_fragments_params) return !1;
    var i = !0,
        c = wc_cart_fragments_params.cart_hash_key;
    try {
        i = "sessionStorage" in window && null !== window.sessionStorage, window.sessionStorage.setItem("wc", "test"), window.sessionStorage.removeItem("wc"), window.localStorage.setItem("wc", "test"), window.localStorage.removeItem("wc")
    } catch (e) {
        i = !1
    }

    function n() {
        i && sessionStorage.setItem("wc_cart_created", (new Date).getTime())
    }

    function a(e) {
        i && (localStorage.setItem(c, e), sessionStorage.setItem(c, e))
    }
    var e = {
        url: wc_cart_fragments_params.wc_ajax_url.toString().replace("%%endpoint%%", "get_refreshed_fragments"),
        type: "POST",
        data: {
            time: (new Date).getTime()
        },
        timeout: wc_cart_fragments_params.request_timeout,
        success: function(e) {
            e && e.fragments && (s.each(e.fragments, function(e, t) {
                s(e).replaceWith(t)
            }), i && (sessionStorage.setItem(wc_cart_fragments_params.fragment_name, JSON.stringify(e.fragments)), a(e.cart_hash), e.cart_hash && n()), s(document.body).trigger("wc_fragments_refreshed"))
        },
        error: function() {
            s(document.body).trigger("wc_fragments_ajax_error")
        }
    };

    function _() {
        s.ajax(e)
    }
    s(document.body).on("wc_fragment_refresh updated_wc_div", function() {
        _()
    });
    var g = null;
    i && (s(document.body).on("added_to_cart removed_from_cart", function(e, t, r) {
        var o = sessionStorage.getItem(c);
        null != o && "" !== o || n(), sessionStorage.setItem(wc_cart_fragments_params.fragment_name, JSON.stringify(t)), a(r)
    }), s(document.body).on("wc_fragments_refreshed", function() {
        clearTimeout(g), g = setTimeout(_, 864e5)
    }), s(window).on("storage onstorage", function(e) {
        c === e.originalEvent.key && localStorage.getItem(c) !== sessionStorage.getItem(c) && _()
    }), s(window).on("pageshow", function(e) {
        e.originalEvent.persisted && (s(".widget_shopping_cart_content").empty(), s(document.body).trigger("wc_fragment_refresh"))
    })), s(document.body).on("minimog_fly_cart_first_open", function() {
        if (i) try {
            var e = JSON.parse(sessionStorage.getItem(wc_cart_fragments_params.fragment_name)),
                t = sessionStorage.getItem(c),
                r = Cookies.get("woocommerce_cart_hash"),
                o = sessionStorage.getItem("wc_cart_created");
            if (null != r && "" !== r || (r = ""), (t = null != t && "" !== t ? t : "") && (null == o || "" === o)) throw "No cart_created";
            if (o) {
                var n = +o + 864e5,
                    a = (new Date).getTime();
                if (n < a) throw "Fragment expired";
                g = setTimeout(_, n - a)
            }
            if (!e || !e["div.widget_shopping_cart_content"] || t !== r) throw "No fragment";
            s.each(e, function(e, t) {
                s(e).replaceWith(t)
            }), s(document.body).trigger("wc_fragments_loaded")
        } catch (e) {
            _()
        } else _()
    }), 0 < Cookies.get("woocommerce_items_in_cart") ? s(".hide_cart_widget_if_empty").closest(".widget_shopping_cart").show() : s(".hide_cart_widget_if_empty").closest(".widget_shopping_cart").hide(), s(document.body).on("adding_to_cart", function() {
        s(".hide_cart_widget_if_empty").closest(".widget_shopping_cart").show()
    }), "undefined" != typeof wp && wp.customize && wp.customize.selectiveRefresh && wp.customize.widgetsPreview && wp.customize.widgetsPreview.WidgetPartial && wp.customize.selectiveRefresh.bind("partial-content-rendered", function() {
        _()
    })
});